---
title: "phenomenology_pilot"
output: 
  html_document:
    code_folding: hide
    theme: cosmo
editor_options:
  chunk_output_type: console
date: "2023-08-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(readr)
library(tidyverse)
library(gtsummary)
```

```{r}
df = read_csv("/Users/olgaiarygina/Documents/GitHub/dc_keyboard/dc_keyboard/study_1/df_full_filtered.csv")
```

```{r}
library(afex)
aov_interaction <- aov_car(wpm ~ keyboard * block1 + Error(identifier/(keyboard * block1)), data = df)

print(aov_interaction)
```

```{r}
std_per_group <- df %>%
  group_by(block1, keyboard) %>%
  summarize(sd = sd(cer))

# Merge the calculated standard deviation values back into the original dataframe
df <- left_join(df, std_per_group, by = c("block1", "keyboard"))

# Create the interaction plot with error bars and confidence intervals using ggplot2
ggplot(df, aes(x = block1, y = cer, color = keyboard)) +
  geom_point(position = position_dodge(width = 0.2)) +
  geom_errorbar(aes(ymin = cer - sd, ymax = cer + sd), position = position_dodge(width = 0.2), width = 0.2) +
  stat_summary(fun = mean, geom = "point", size = 3, position = position_dodge(width = 0.2)) +
  labs(title = "Interaction Plot of CER for Different Keyboard Conditions and Blocks",
       x = "Block",
       y = "CER") +
  theme_minimal()
```

```{r}
library(ggpubr)
ggline(df, x = "block1", y = "wpm", color = "keyboard",
       add = c("mean_ci"),
       palette = c("#00AFBB", "#E7B800"),
       title = "Interaction Plot of CER for Different Keyboard Conditions and Blocks",
       xlab = "Block",
       ylab = "wpm")
```

```{r}
ggplot(df, aes(x = block1, y = wpm, color = keyboard)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.2)) +
  geom_errorbar(stat = "summary", fun.data = mean_se, position = position_dodge(width = 0.2), width = 0.2) +
 # geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.5, position = position_dodge(width = 0.2)) +
  labs(title = "Interaction Plot of CER for Different Keyboard Conditions and Blocks",
       x = "block",
       y = "wpm") +
  theme_minimal()

```

```{r}
ggplot(df, aes(x = block1, y = wpm, color = keyboard)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.2)) +
  geom_errorbar(stat = "summary", fun.data = mean_ci, position = position_dodge(width = 0.2), width = 0.2) +
 # geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.5, position = position_dodge(width = 0.2)) +
  labs(title = "Interaction Plot of wpm for Different Keyboard Conditions and Blocks",
       x = "block",
       y = "wpm") +
  theme_minimal()
```

